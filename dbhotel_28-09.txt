ESERCIZI 26-09



1. Fai un'analisi per vedere se ci sono ore in cui le prenotazioni sono più frequenti.

SELECT COUNT(`id`), HOUR(`created_at`)
FROM `prenotazioni`  
GROUP BY HOUR(`created_at`)  
ORDER BY COUNT(`id`) DESC;

2. Le stanze sono state tutte prenotate almeno una volta? (Visualizzare le stanze non ancora prenotate)

SELECT `stanze`.`room_number` 
FROM `prenotazioni`
RIGHT JOIN `stanze`
ON `prenotazioni`.`stanza_id` = `stanze`.`id`
WHERE `prenotazioni`.`id` IS NULL;

3. Come si chiamano gli ospiti che hanno fatto più di due prenotazioni?

SELECT COUNT(`id`), `ospite_id`
FROM `prenotazioni_has_ospiti`
GROUP BY `ospite_id`
HAVING count(`id`) >= 2;